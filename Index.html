<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MB Music</title>
    <style>
        :root {
            --primary: #ff3e3e;
            --primary-dark: #cc0000;
            --text: #333;
            --text-light: #777;
            --bg: #f5f5f5;
            --card-bg: #fff;
            --player-bg: #fff;
            --header-bg: #ff3e3e;
        }
        
        .dark-mode {
            --primary: #ff6b6b;
            --primary-dark: #ff3e3e;
            --text: #f0f0f0;
            --text-light: #aaa;
            --bg: #121212;
            --card-bg: #1e1e1e;
            --player-bg: #000;
            --header-bg: #1a1a1a;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            transition: background 0.3s, color 0.3s;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            min-height: 100vh;
            padding-bottom: 80px; /* Espa√ßo para o player */
        }

        header {
            background-color: var(--header-bg);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .nav-buttons {
            display: flex;
            gap: 15px;
        }

        .nav-button {
            background: none;
            border: none;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
        }

        .nav-button:hover {
            background: rgba(255,255,255,0.2);
        }

        #search-container {
            padding: 20px;
            text-align: center;
            background-color: var(--bg);
            position: sticky;
            top: 0;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        #search-input {
            padding: 12px 15px;
            width: 70%;
            max-width: 500px;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            background-color: var(--card-bg);
            color: var(--text);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        #search-button {
            padding: 12px 20px;
            background-color: var(--primary);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            margin-left: 10px;
            font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        #search-button:hover {
            background-color: var(--primary-dark);
        }

        #results {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            padding: 20px;
        }

        .video-card {
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .video-card:hover {
            transform: translateY(-5px);
        }

        .video-card img {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .video-info {
            padding: 15px;
        }

        .video-title {
            font-size: 1rem;
            margin-bottom: 5px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-channel {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 10px;
        }

        /* Player Profissional */
        #player-container {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: var(--player-bg);
            padding: 15px 20px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: none;
            align-items: center;
            z-index: 1000;
        }

        .player-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 15px;
            max-width: 30%;
        }

        .player-thumbnail {
            width: 50px;
            height: 50px;
            border-radius: 5px;
            object-fit: cover;
        }

        .player-text {
            overflow: hidden;
        }

        .player-song {
            font-weight: bold;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-artist {
            font-size: 0.8rem;
            color: var(--text-light);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .player-controls {
            flex: 2;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
        }

        .control-button {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.2rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .control-button:hover {
            background: rgba(255, 62, 62, 0.1);
        }

        .play-button {
            background: var(--primary);
            color: white;
            width: 50px;
            height: 50px;
            font-size: 1.5rem;
        }

        .favorite-button {
            color: var(--primary);
            margin-left: auto;
            font-size: 1.5rem;
        }

        .favorite-button.active {
            color: white;
            background: var(--primary);
        }

        .progress-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: rgba(0,0,0,0.1);
        }

        .progress-bar {
            height: 100%;
            background: var(--primary);
            width: 0%;
        }

        /* Iframe invis√≠vel para o player do YouTube */
        #youtube-player {
            display: none;
        }

        @media (max-width: 768px) {
            #search-input {
                width: 60%;
            }
            
            .player-info {
                max-width: 40%;
            }
            
            .player-controls {
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- P√°gina Principal -->
    <div id="home-page">
        <header>
            <div class="logo">MB Music</div>
            <div class="nav-buttons">
                <button id="dark-mode-toggle" class="nav-button">üåì</button>
            </div>
        </header>

        <div id="search-container">
            <input type="text" id="search-input" placeholder="Buscar m√∫sicas...">
            <button id="search-button">Buscar</button>
        </div>

        <div id="results"></div>
    </div>

    <!-- Player Fixo -->
    <div id="player-container">
        <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
        </div>
        
        <div class="player-info">
            <img src="" alt="Capa" class="player-thumbnail" id="player-thumbnail">
            <div class="player-text">
                <div class="player-song" id="player-song">Nenhuma m√∫sica selecionada</div>
                <div class="player-artist" id="player-artist">MB Music</div>
            </div>
        </div>
        
        <div class="player-controls">
            <button class="control-button" id="prev-button">‚èÆ</button>
            <button class="control-button play-button" id="play-button">‚ñ∂</button>
            <button class="control-button" id="next-button">‚è≠</button>
        </div>
        
        <button class="control-button favorite-button" id="favorite-button">‚ù§</button>
    </div>

    <!-- Player do YouTube (invis√≠vel) -->
    <iframe id="youtube-player" frameborder="0" allowfullscreen="1" allow="autoplay"></iframe>

    <script>
        // Configura√ß√µes
        const API_KEY = "AIzaSyC_8CHxOvjcNCs36B-Omt3v5VjzVAazdIw";
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let darkMode = localStorage.getItem('darkMode') === 'true';
        let currentVideo = null;
        let isPlaying = false;
        let player; // Objeto do player do YouTube

        // Elementos
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');
        const resultsDiv = document.getElementById('results');
        const playerContainer = document.getElementById('player-container');
        const playerThumbnail = document.getElementById('player-thumbnail');
        const playerSong = document.getElementById('player-song');
        const playerArtist = document.getElementById('player-artist');
        const playButton = document.getElementById('play-button');
        const prevButton = document.getElementById('prev-button');
        const nextButton = document.getElementById('next-button');
        const favoriteButton = document.getElementById('favorite-button');
        const progressBar = document.getElementById('progress-bar');
        const darkModeToggle = document.getElementById('dark-mode-toggle');
        const youtubePlayer = document.getElementById('youtube-player');

        // Inicializa√ß√£o
        if (darkMode) {
            document.body.classList.add('dark-mode');
        }

        // Carrega a API do YouTube
        function loadYouTubeAPI() {
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
        }

        // Callback quando a API do YouTube est√° pronta
        window.onYouTubeIframeAPIReady = function() {
            player = new YT.Player('youtube-player', {
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange
                }
            });
        };

        // Quando o player est√° pronto
        function onPlayerReady(event) {
            console.log("Player do YouTube pronto");
        }

        // Quando o estado do player muda
        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                isPlaying = true;
                playButton.textContent = '‚è∏';
                simulateProgress();
            } else if (event.data === YT.PlayerState.PAUSED) {
                isPlaying = false;
                playButton.textContent = '‚ñ∂';
            } else if (event.data === YT.PlayerState.ENDED) {
                isPlaying = false;
                playButton.textContent = '‚ñ∂';
                progressBar.style.width = '0%';
            }
        }

        // Buscar v√≠deos
        async function searchVideos() {
            const query = searchInput.value.trim();
            if (!query) return;

            try {
                const response = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&q=${query}&key=${API_KEY}&maxResults=15&type=video`);
                const data = await response.json();
                displayResults(data.items);
            } catch (error) {
                console.error("Erro na busca:", error);
                resultsDiv.innerHTML = "<p style='text-align:center;color:var(--text-light)'>Erro ao carregar v√≠deos. Tente novamente.</p>";
            }
        }

        // Mostrar resultados
        function displayResults(videos) {
            resultsDiv.innerHTML = '';
            
            if (videos.length === 0) {
                resultsDiv.innerHTML = "<p style='text-align:center;color:var(--text-light)'>Nenhum resultado encontrado</p>";
                return;
            }

            videos.forEach(video => {
                const videoCard = document.createElement('div');
                videoCard.className = 'video-card';
                videoCard.innerHTML = `
                    <img src="${video.snippet.thumbnails.medium.url}" alt="${video.snippet.title}">
                    <div class="video-info">
                        <h3 class="video-title">${video.snippet.title}</h3>
                        <p class="video-channel">${video.snippet.channelTitle}</p>
                    </div>
                `;
                
                videoCard.addEventListener('click', () => {
                    playVideo(
                        video.id.videoId,
                        video.snippet.title,
                        video.snippet.channelTitle,
                        video.snippet.thumbnails.medium.url
                    );
                });
                
                resultsDiv.appendChild(videoCard);
            });
        }

        // Reproduzir v√≠deo
        function playVideo(videoId, title, artist, thumbnail) {
            currentVideo = { videoId, title, artist, thumbnail };
            
            // Atualizar player
            playerThumbnail.src = thumbnail;
            playerSong.textContent = title;
            playerArtist.textContent = artist;
            playerContainer.style.display = 'flex';
            
            // Atualizar bot√£o de favorito
            favoriteButton.classList.toggle('active', favorites.includes(videoId));
            
            // Configurar MediaSession
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: title,
                    artist: artist,
                    artwork: [
                        { src: thumbnail, sizes: '300x300' }
                    ]
                });

                navigator.mediaSession.setActionHandler('play', () => togglePlay());
                navigator.mediaSession.setActionHandler('pause', () => togglePlay());
                navigator.mediaSession.setActionHandler('previoustrack', () => console.log('Previous'));
                navigator.mediaSession.setActionHandler('nexttrack', () => console.log('Next'));
            }
            
            // Carregar e reproduzir o v√≠deo
            if (player) {
                player.loadVideoById(videoId);
                player.playVideo();
            } else {
                youtubePlayer.src = `https://www.youtube.com/embed/${videoId}?enablejsapi=1&autoplay=1`;
            }
        }

        // Alternar play/pause
        function togglePlay() {
            if (!player) return;
            
            if (isPlaying) {
                player.pauseVideo();
            } else {
                player.playVideo();
            }
        }

        // Simular barra de progresso
        function simulateProgress() {
            let progress = 0;
            const interval = setInterval(() => {
                if (!isPlaying) {
                    clearInterval(interval);
                    return;
                }
                
                progress += 0.5;
                progressBar.style.width = `${progress}%`;
                
                if (progress >= 100) {
                    clearInterval(interval);
                    progressBar.style.width = '0%';
                }
            }, 1000);
        }

        // Alternar favorito
        function toggleFavorite() {
            if (!currentVideo) return;
            
            const videoId = currentVideo.videoId;
            if (favorites.includes(videoId)) {
                favorites = favorites.filter(id => id !== videoId);
                favoriteButton.classList.remove('active');
            } else {
                favorites.push(videoId);
                favoriteButton.classList.add('active');
            }
            
            localStorage.setItem('favorites', JSON.stringify(favorites));
        }

        // Alternar modo escuro
        function toggleDarkMode() {
            darkMode = !darkMode;
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', darkMode);
        }

        // Event listeners
        searchButton.addEventListener('click', searchVideos);
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') searchVideos();
        });
        
        playButton.addEventListener('click', togglePlay);
        favoriteButton.addEventListener('click', toggleFavorite);
        darkModeToggle.addEventListener('click', toggleDarkMode);

        // Carrega a API do YouTube quando a p√°gina carrega
        loadYouTubeAPI();
    </script>
</body>
</html>